context("test_.fix_names - unit tests")

test_that(".fix_names returns expected tibble", {
  old_names <- dplyr::tibble(
    "#chr" = c(""),
    "MAP20(+-149bp)" = c(""),
    "MAP35(+-149bp)" = c(""),
    "GMS_single-end" = c(""),
    "GMS_paired-end" = c(""),
    "H1-hESC_fitCons_score" = c(""),
    "H1-hESC_fitCons_rankscore" = c(""),
    "1000G_strict_masked" = c(""),
    "1000Gp3_AC" = c(""),
    "1000Gp3_AF" = c(""),
    "1000Gp3_AFR_AC" = c(""),
    "1000Gp3_AFR_AF" = c(""),
    "1000Gp3_EUR_AC" = c(""),
    "1000Gp3_EUR_AF" = c(""),
    "1000Gp3_AMR_AC" = c(""),
    "1000Gp3_AMR_AF" = c(""),
    "1000Gp3_SAS_AC" = c(""),
    "1000Gp3_SAS_AF" = c(""),
    "1000Gp3_EAS_AC" = c(""),
    "1000Gp3_EAS_AF" = c(""),
    "fathmm-MKL_non-coding_score" = c(""),
    "fathmm-MKL_non-coding_rankscore" = c(""),
    "fathmm-MKL_coding_score" = c(""),
    "fathmm-MKL_coding_rankscore" = c(""),
    "Eigen-raw" = c(""),
    "Eigen-phred" = c(""),
    "Eigen-raw_rankscore" = c(""),
    "Eigen-PC-raw" = c(""),
    "Eigen-PC-raw_rankscore" = c(""),
    "CADDraw" = c(""),
    "CADDphred" = c(""),
    "MAP20(+-149bp)_unparsed" = c(""),
    "MAP35(+-149bp)_unparsed" = c(""),
    "GMS_single-end_unparsed" = c(""),
    "GMS_paired-end_unparsed" = c(""),
    "H1-hESC_fitCons_score_unparsed" = c(""),
    "H1-hESC_fitCons_rankscore_unparsed" = c(""),
    "1000G_strict_masked_unparsed" = c(""),
    "fathmm-MKL_non-coding_score_unparsed" = c(""),
    "fathmm-MKL_non-coding_rankscore_unparsed" = c(""),
    "fathmm-MKL_coding_score_unparsed" = c(""),
    "fathmm-MKL_coding_rankscore_unparsed" = c(""),
    "Eigen-raw_unparsed" = c(""),
    "Eigen-phred_unparsed" = c(""),
    "Eigen-raw_rankscore_unparsed" = c(""),
    "Eigen-PC-raw_unparsed" = c(""),
    "Eigen-PC-raw_rankscore_unparsed" = c("")
  )
  target <- dplyr::tibble(
    "chr" = c(""),
    "MAP20_149bp" = c(""),
    "MAP35_149bp" = c(""),
    "GMS_single_end" = c(""),
    "GMS_paired_end" = c(""),
    "H1_hESC_fitCons_score" = c(""),
    "H1_hESC_fitCons_rankscore" = c(""),
    "KGP_strict_masked" = c(""),
    "KGP3_AC" = c(""),
    "KGP3_AF" = c(""),
    "KGP3_AFR_AC" = c(""),
    "KGP3_AFR_AF" = c(""),
    "KGP3_EUR_AC" = c(""),
    "KGP3_EUR_AF" = c(""),
    "KGP3_AMR_AC" = c(""),
    "KGP3_AMR_AF" = c(""),
    "KGP3_SAS_AC" = c(""),
    "KGP3_SAS_AF" = c(""),
    "KGP3_EAS_AC" = c(""),
    "KGP3_EAS_AF" = c(""),
    "fathmm_MKL_non_coding_score" = c(""),
    "fathmm_MKL_non_coding_rankscore" = c(""),
    "fathmm_MKL_coding_score" = c(""),
    "fathmm_MKL_coding_rankscore" = c(""),
    "Eigen_raw" = c(""),
    "Eigen_phred" = c(""),
    "Eigen_raw_rankscore" = c(""),
    "Eigen_PC_raw" = c(""),
    "Eigen_PC_raw_rankscore" = c(""),
    "CADD_raw" = c(""),
    "CADD_phred" = c(""),
    "MAP20_149bp_unparsed" = c(""),
    "MAP35_149bp_unparsed" = c(""),
    "GMS_single_end_unparsed" = c(""),
    "GMS_paired_end_unparsed" = c(""),
    "H1_hESC_fitCons_score_unparsed" = c(""),
    "H1_hESC_fitCons_rankscore_unparsed" = c(""),
    "KGP_strict_masked_unparsed" = c(""),
    "fathmm_MKL_non_coding_score_unparsed" = c(""),
    "fathmm_MKL_non_coding_rankscore_unparsed" = c(""),
    "fathmm_MKL_coding_score_unparsed" = c(""),
    "fathmm_MKL_coding_rankscore_unparsed" = c(""),
    "Eigen_raw_unparsed" = c(""),
    "Eigen_phred_unparsed" = c(""),
    "Eigen_raw_rankscore_unparsed" = c(""),
    "Eigen_PC_raw_unparsed" = c(""),
    "Eigen_PC_raw_rankscore_unparsed" = c("")
  )
  result <- .fix_names(old_names)
  expect_identical(result, target)
})
